# Grooming Plan — 2026-02-23

## Session Context

- **Product**: Heartbeat — indie SaaS uptime monitoring, beautiful public status pages
- **Target User**: Solo devs / indie hackers
- **Current Focus**: Launch readiness

## Themes Explored (All 5)

1. **Marketing Integrity** — Fix landing page broken promises (Slack, custom domains, fabricated stats)
2. **Launch Readiness** — Data retention bug, trial enforcement, interval selector, upgrade CTA
3. **Notification Stack** — Slack + Discord + HMAC + webhook retry + dunning email
4. **Engine Reliability** — SSRF security, test coverage, atomicity, degraded status
5. **Competitive Expansion** — SSL monitoring, cron/heartbeat monitoring

## Issues Created

| #    | Title                                                     | P   | Type            | Horizon |
| ---- | --------------------------------------------------------- | --- | --------------- | ------- |
| #106 | Fix landing page broken promises                          | P0  | Task            | now     |
| #107 | Fix SSRF: IPv6, redirect bypass, consolidate validation   | P0  | Bug             | now     |
| #108 | Fix data retention: tier-aware cleanup (Vital = 90 days)  | P0  | Bug             | now     |
| #109 | Fix trial tier enforcement: TRIAL_TIER not consumed       | P1  | Bug             | next    |
| #110 | Notification schema: Slack, Discord, webhookSecret fields | P1  | Task            | next    |
| #111 | Slack notifications via Incoming Webhooks                 | P1  | Feature         | next    |
| #112 | Discord notifications via webhook                         | P1  | Feature         | next    |
| #113 | HMAC-SHA256 + timestamp replay protection for webhooks    | P1  | Feature         | next    |
| #114 | Webhook delivery retry (1 retry, 30s backoff)             | P1  | Task            | next    |
| #115 | Dunning email on invoice.payment_failed                   | P1  | Task            | next    |
| #116 | Upgrade CTA when hitting monitor limit                    | P1  | Feature         | next    |
| #117 | Write 'degraded' status to check records                  | P1  | Bug             | next    |
| #118 | Make recordCheck + updateMonitorStatus atomic             | P1  | Task (Refactor) | next    |
| #119 | Test coverage: state machine edge cases + check engine    | P1  | Task            | next    |
| #120 | Interval selector in AddMonitorForm (tier-gated)          | P2  | Feature         | later   |
| #121 | Performance: compound index + cap unbounded queries       | P2  | Task            | later   |
| #122 | SSL certificate monitoring (30/14/7 day alerts)           | P2  | Feature         | later   |
| #123 | Cron/heartbeat monitoring (ping URL + staleness check)    | P2  | Feature         | later   |

## Duplicates Flagged (Confirm Before Closing)

- **#33** (IPv6 SSRF bypass) → superseded by **#107** (broader SSRF fix including #33's scope)
- **#48** (duplicate SSRF validation) → superseded by **#107** (consolidation is part of #107)
- **#38** (incidents N+1) → covered by **#121** (one of three perf issues in #121)

Recommend closing #33 and #48 with link to #107. Keep #38 open or close referencing #121.

## Label Hygiene Applied

- Migrated `horizon/next` → `next` on: #50, #47, #37, #34
- Migrated `horizon/soon` → `next` on: #56, #54, #33, #26, #25, #24, #23, #22, #21, #20
- Migrated `horizon/later` → `later` on: #82, #81, #69, #68, #67, #66, #65, #53, #51, #36
- Triaged unlabeled issues #102, #99, #97 as p3/refactor/later/domain/ui

## Research Findings

### Critical discoveries

1. **Landing page lies** — Slack, custom domains, API access, fabricated stats are all false claims
2. **Data retention bug** — Vital users are losing paid-for history daily (30-day cleanup applies to all)
3. **Trial enforcement broken** — TRIAL_TIER constant defined but never consumed by Convex
4. **Redirect SSRF bypass** — `redirect: 'follow'` default lets public-domain → internal-IP bypasses work

### Market context

- UptimeRobot Nov 2024 ToS change banned commercial use on free tier → migration wave still active
- Slack + Discord + email = minimum viable notification stack for indie hacker audience
- SSL monitoring is table stakes (not a differentiator)
- Status page themes ARE the real moat — invest design there, not just parity features

### Architecture decisions locked

- Notification channels: paste-URL pattern (not OAuth), named fields on userSettings (not channels array yet)
- Cron monitoring: HTTP ping endpoint + timestamp staleness in existing heartbeat cron
- SSL monitoring: Node.js `tls.connect` in Convex action, daily cron

## Deferred

- Custom domains: week+ build, defer to next quarter after notifications land
- Multi-region checks: 2-3 day build, defer after core reliability is solid
- AI triage / Sentry-adjacent features: 2026-2027 horizon
- PagerDuty integration: after Slack/Discord prove out the notification architecture

## Quality Scores (Self-Assessed)

All 18 issues have: Given/When/Then ACs, specific affected files, executable verification, recommended approach with code, Mermaid diagram, all canonical labels, milestone assignment. Estimated score: 90+/100 each.

---

_Session date: 2026-02-23_
_Issues created: #106-#123 (18 new)_
